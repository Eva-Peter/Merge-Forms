# WPS/excel 表格合并工具

一个表格文件合并工具，支持按行或按列合并多个表格文件。

## 功能特点

- 支持多种表格格式合并
- 支持按行合并和按列合并两种模式
- 可指定标题行数或标题列数
- 自动创建结果文件，包含时间戳
- 智能类型检查，确保文件格式一致性

## 支持的文件格式

- Excel 文件 (.xlsx, .xls, .xlt)
- WPS 表格 (.et, .ets)
- CSV 文件 (.csv)
- XML 表格 (.xml)

## 安装方法
### wps
1. 保存 `合并表格wps.xlam` 文件；也可以复制 [合并表格wps.txt](https://github.com/Eva-Peter/Merge-Forms/blob/main/%E5%90%88%E5%B9%B6%E8%A1%A8%E6%A0%BCwps.txt) 的代码，在wps宏编辑器上粘贴并保存表格为 `xlam` 格式
2. 点击 `工具->加载项->浏览->选择刚保存的文件->确定`（建议放在不易被删除的路径或wps默认路径）
3. 此时顶部工具栏的 `加载项` 中应该多了一个 `合并表格` 的项
### excel
1. 保存 `合并表格excel.xlam` 文件；也可以复制 [合并表格excel.txt](https://github.com/Eva-Peter/Merge-Forms/blob/main/%E5%90%88%E5%B9%B6%E8%A1%A8%E6%A0%BCexcel.txt) 的代码，在excel宏编辑器上粘贴并保存为 `xlam` 格式
   - 宏编辑器打开方式：`开发工具->Visual Basic->左侧找到VBA Project(工作簿1)->插入模块->弹出宏编辑窗口`
2. 点击 `开发工具->Excel加载项->浏览->选择刚保存的文件->确定`（建议放在不易被删除的路径或excel默认路径）
3. 此时加载项中应多出了 `合并表单` 的选项
   - 若没出现，建议在 `文件->选项->快速访问工具栏->选择“宏”->MergeExcelSheets->添加->确定` 添加 

## 使用说明

1. 打开任意 WPS 表格文件
2. 在菜单栏找到 `加载项->合并表格`
3. 点击"合并表格"选项
4. 在弹出的文件选择对话框中选择需要合并的文件（至少2个）
5. 输入合并参数（不区分大小写）：
   - `H数字`：按行合并，数字表示保留的标题行数
     - 例如：`H1` 表示保留1行标题
   - `L数字`：按列合并，数字表示保留的标题列数
     - 例如：`L2` 表示保留2列标题

## 注意事项

- 确保所选文件格式相同
- 结果文件将自动保存在第一个选择的文件所在目录
- 文件名格式：`合并结果_年月日时分秒.格式`

## 常见问题

Q: 为什么提示文件格式不一致？  
A: 工具要求所有待合并文件格式必须相同，如不能同时合并 .xlsx 和 .csv 文件。

Q: 合并参数格式错误怎么办？  
A: 确保使用正确的格式：H数字 或 L数字，例如 H1、L2 等。
